OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
debugSource('D:/Desktop/Data/Community data analysis/2Biomarkers Character&5Permutation/OTU.permutation.R')
debugSource('D:/Desktop/Data/Community data analysis/2Biomarkers Character&5Permutation/OTU.permutation.R')
OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
adonis(unifrac~group,permutations=1)$aov.tab$F.Model
length(Class1)
length(Class2)
Class1<-Class1[1:45]
OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
debugSource('D:/Desktop/Data/Community data analysis/2Biomarkers Character&5Permutation/OTU.permutation.R')
OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
debugSource('D:/Desktop/Data/Community data analysis/2Biomarkers Character&5Permutation/OTU.permutation.R')
OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
debugSource('D:/Desktop/Data/Community data analysis/2Biomarkers Character&5Permutation/OTU.permutation.R')
OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
View(Gunifrac)
metaMDS(Gunifrac,k=3)
metaMDS(Gunifrac,k=2)
metaMDS(Gunifrac,k=2)->t
qplot(t)
qplot(t$points)
qplot(as.data.frame(t$points))
t$points
str(t$points)
as.data.frame(t$points)->t
t
qplot(t,color=Class1)
qplot(MDS1,MDS2,data=t,aes(color=Class1))
qplot(MDS1,MDS2,data=t,aes(color=grou[]))
qplot(MDS1,MDS2,data=t,aes(color=group))
qplot(MDS1,MDS2,data=t,color=group)
qplot(MDS1,MDS2,data=t,color=as.factor(group))
adonis(w0.5unifrac~Class1,permutations=1)$aov.tab$F.Model
adonis(w0.5unifrac[1:45,1:45]~Class1,permutations=1)$aov.tab$F.Model
Class1
OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
GUniFrac(otutable,phylotre,alpha=0.5)$unifracs->unifracs
grou[]
group
length(group)
unifracs[,,"d_0.5"]->Gunifrac
unifracs[,,"d_0.5"]
View(w0.5unifrac)
View(data)
GUniFrac(data,root.phylotre,alpha = 0.5)$unifracs[,,"0.5"]
GUniFrac(data,root.phylotre,alpha = 0.5)->test
dim(test$unifracs)
View(test$unifracs[,,"d_0.5"])
debugSource('D:/Desktop/Data/Community data analysis/2Biomarkers Character&5Permutation/OTU.permutation.R')
OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
View(otutable)
View(otutable)
View(OTU.permutate)
debugSource('D:/Desktop/Data/Community data analysis/2Biomarkers Character&5Permutation/OTU.permutation.R')
OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
OTU.permutate(data,as.numeric(Class1),root.phylotre,part=Sig)
dim(otutable)
dim(data)
data==otutable
length(data==otutable)
str(Class1)
OTU.permutate(data,Class1,root.phylotre,part=Sig)
source('D:/Desktop/Data/Community data analysis/2Biomarkers Character&5Permutation/OTU.permutation.R')
OTU.permutate(data,Class1,root.phylotre,part=Sig)
dim(data)
Nul<-rep(FALSE,6100)
Nul[Sig]<-TRUE
which(Nul)->Nul
length(Nul)
Nul<-rep(TRUE,6100)
Nul[Sig]<-FALSE
which(Nul)->Nul
length(Nul)
OTU.permutate(data,Class1,root.phylotre,part=Nul)
temp<-matrix(nrow=61,ncol=5)
source('D:/Desktop/Data/Community data analysis/2Biomarkers Character&5Permutation/OTU.permutation.R')
for(i in 1:61) OTU.permutate(data,Class1,root.phylotre,num=i*100,time=300)->temp[i,]
for(i in 1:61) {OTU.permutate(data,Class1,root.phylotre,num=i*100,time=300)->temp[i,];cat(i)}
for(i in 1:61) {OTU.permutate(data,Class1,root.phylotre,num=i*100,time=300)->temp[i,];cat(i)}
temp
i
for(i in 19:20) {OTU.permutate(data,Class1,root.phylotre,num=i*100,time=300)->temp[i,];cat(i)}
temp
q()
View(rare)
Sample.Type
dim(rare)
Sample.Type<-Sample.Type[1:45]
View(FDR)
qplot(x1,x2,data=meta.dat)
meta
str(meta)
str(data)
str(rare)
str(result)
permute_differential_analysis
View(permute_differential_analysis)
source('D:/World Forest Data/Fuyang/data/DAA.R', encoding = 'UTF-8')
source('D:/World Forest Data/Fuyang/data/DAA.R')
permute_differential_analysis(meta,rare,'class',perm.no = 9999)->result
library(matrixStats)
permute_differential_analysis(meta,rare,'class',perm.no = 9999)->result
debugSource('D:/World Forest Data/Fuyang/data/DAA.R')
permute_differential_analysis(meta,rare,'class',perm.no = 9999)->result
debugSource('D:/World Forest Data/Fuyang/data/DAA.R')
permute_differential_analysis
View(permute_differential_analysis)
permute_differential_analysis(meta,rare,'class',perm.no = 9999)->result
rm(permute_differential_analysis)
permute_differential_analysis(meta,rare,'class',perm.no = 9999)->result
debugSource('D:/World Forest Data/Fuyang/data/DAA.R')
permute_differential_analysis(meta,rare,'class',perm.no = 9999)->result
permute_differential_analysis(meta,rare,'class',perm.no = 9999)->result
dim(data)
dim(rare)
permute_differential_analysis(meta,t(rare),'class',perm.no = 9999)->result
GMPR(data)
GMPR(t(data))
GMPR(t(rare))
permute_differential_analysis(meta,t(rare),'class',perm.no = 9999)->result
View(Y)
View(M0)
str(meta)
permute_differential_analysis(meta,t(rare),'meta',perm.no = 9999)->result
View(meta.dat)
View(df1)
resid(lm(M1 ~ M0 - 1))
View(M1)
View(M0)
str(M1)
str(M0)
permute_differential_analysis(meta[c(-1,-3)],t(rare[c(-1,-3),]),'class',perm.no = 999)->result.drop
permute_differential_analysis(meta[c(-1,-3)],t(rare[c(-1,-3),]),'meta',perm.no = 999)->result.drop
dim(rare[c(-1,-3),])
length(meta[c(-1,-3)])
meta
meta[c(-1,-3)]
permute_differential_analysis(meta[c(-1,-3),],t(rare[c(-1,-3),]),'meta',perm.no = 999)->result.drop
FDR.drop<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
meta[c(-1,-3),]->meta.drop;rare[c(-1,-3),]->rare.drop
permute_differential_analysis(meta.drop,rare.drop,'meta',perm.no = 999)->result.drop
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
model.matrix(~ 1, meta.dat)
permute_differential_analysis(meta,t(rare),'meta',perm.no = 9999)->result
model.matrix(~ 1, meta.dat)
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
data.frame(meta=meta[c(-1,-3),])->meta.drop;rare[c(-1,-3),]->rare.drop
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
FDR.drop<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
rownames(FDR.drop)<-names(result.drop$p.raw)
dim(FDR.drop[FDR.drop$fdr<0.001,])
View(FDR.drop)
View(FDR.drop[FDR.drop$fdr<0.001,])
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
FDR.drop<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
View(FDR.drop)
FDR.drop[is.na(FDR.drop$raw),]->FDR.drop
dim(FDR.drop[FDR.drop$fdr<0.001,])
View(FDR.drop[FDR.drop$fdr<0.001,])
FDR.drop<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
rownames(FDR.drop)<-names(result.drop$p.raw)
FDR.drop[!is.na(FDR.drop$raw),]->FDR.drop
dim(FDR.drop[FDR.drop$fdr<0.001,])
View(FDR.drop[FDR.drop$fdr<0.001,])
View(anno)
row.names(anno)
row.names(FDR.drop)
row.names(FDR.drop[FDR.drop$fdr<0.001])
row.names(FDR.drop[FDR.drop$fdr<0.001,])
row.names(anno)
source('D:/World Forest Data/Fuyang/data/DAA.R')
dim(FDR.drop[FDR.drop$fdr<0.001,])
data.frame(meta=meta[c(-1,-3),])->meta.drop;rare[c(-1,-3),]->rare.drop
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
library(matrixStats)
source('D:/World Forest Data/Fuyang/data/DAA.R')
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
FDR.drop<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
View(FDR)
ownames(FDR.drop)<-names(result.drop$p.raw)
rownames(FDR.drop)<-names(result.drop$p.raw)
FDR.drop[!is.na(FDR.drop$raw),]->FDR.drop
dim(FDR.drop[FDR.drop$fdr<0.001,])
dim(FDR)
dim(FDR.drop)
dim(FDR[FDR.drop$fdr<0.001,])
dim(FDR[FDR$fdr<0.001,])
dim(FDR[FDR$FDR<0.001,])
dim(FDR)
dim(FDR[FDR$FDR<0.001,])
731/6100
622/5714
dim(rare)
dim(data)
colnames(data)
rownames(data)
dim(FDR.drop[FDR.drop$fdr<0.001,]->temp)
View(phylo)
View(anno.data)
View(phylo)
View(rare)
View(phylo)
sum(colnames(rare)!=phylo$X.OTU.ID)
dim(rare)
dim(phylo)
sum(rownames(FDR.drop)!=colnames(rare))
rownames(FDR.drop)[1:10]
colnames(rare)[1:10]
rownames(FDR.drop)[1:10]==colnames(rare)[1:10]
dim(rownames(FDR.drop))
length(rownames(FDR.drop))
dim9phylo[which(rownames(phylo)%in%colnames(rare)),])
dim(phylo[which(rownames(phylo)%in%colnames(rare)),])
dim(phylo[phylo$X.OTU.ID%in%colnames(rare),])
phylo[phylo$X.OTU.ID%in%colnames(rare),]->phylo.rare
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->temp
View(temp)
str(temp)
identical(temp,result.drop)
temp.drop<-data.frame(raw=temp$p.raw,fdr=temp$p.adj.fdr,fwer=temp$p.adj.fwer)
View(temp.drop)
View(result.drop)
source('D:/World Forest Data/Fuyang/data/DAA.R')
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
FDR.drop<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
FDR.drop<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
FDR.drop<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
temp1<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
temp2<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
temp3<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 999)->result.drop
temp4<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
View(temp1)
View(temp2)
View(temp3)
View(temp4)
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 9999)->result.drop
temp4<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 9999)->result.drop
temp3<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
source('D:/World Forest Data/Fuyang/data/DAA.R')
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 9999)->result.drop
temp2<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
source('D:/World Forest Data/Fuyang/data/DAA.R')
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 9999)->result.drop
temp2<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 9999)->result.drop
temp1<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
View(temp1)
View(temp2)
View(temp)
View(temp3)
View(temp4)
phylo[phylo$X.OTU.ID %in% rownames(FDR.drop),]->phylo.drop
rare[colnames(rare) %in% rownames(FDR.drop),]->rare.drop
dim(FDR.drop[FDR.drop$fdr<0.001,]->temp)
rare[,colnames(rare) %in% rownames(FDR.drop)]->rare.drop
if(sum(colnames(rare.drop)==rownames(FDR.drop))+phylo.drop$X.OTU.ID==rownames(FDR.drop)) TRUE
sum(colnames(rare.drop)==rownames(FDR.drop))
sum(colnames(rare.drop)!=rownames(FDR.drop)
)
sum(phylo.drop$X.OTU.ID!=rownames(FDR.drop))
if(sum(colnames(rare.drop)!=rownames(FDR.drop))+sum(phylo.drop$X.OTU.ID!=rownames(FDR.drop)))
warning("Rare.drop, FDR.drop, phylo.drop don't match.")
length(index)
dim(phylo.drop)
dim(rare.drop)
dim(FDR.drop)
data.frame(meta=meta[c(-1,-3),])->meta.drop;rare[c(-1,-3),]->rare.drop
permute_differential_analysis(meta.drop,t(rare.drop),'meta',perm.no = 9999)->result.drop
FDR.drop<-data.frame(raw=result.drop$p.raw,fdr=result.drop$p.adj.fdr,fwer=result.drop$p.adj.fwer)
rownames(FDR.drop)<-names(result.drop$p.raw)
FDR.drop[!is.na(FDR.drop$raw),]->FDR.drop
dim(FDR.drop[FDR.drop$fdr<0.001,]->temp)
phylo[phylo$X.OTU.ID %in% rownames(FDR.drop),]->phylo.drop
dim(FDR.drop)
phylo[phylo$X.OTU.ID %in% rownames(FDR.drop),]->phylo.drop
dim(phylo.drop)
rare.drop[,colnames(rare) %in% rownames(FDR.drop)]->rare.drop
dim(rare.drop)
if(sum(colnames(rare.drop)!=rownames(FDR.drop))+sum(phylo.drop$X.OTU.ID!=rownames(FDR.drop)))
warning("Rare.drop, FDR.drop, phylo.drop don't match.")
dim(rare)
which(phylo.drop$X.OTU.ID %in% rownames(temp))->Sig.drop
which(!(phylo.drop$X.OTU.ID %in% rownames(temp)))->Nul.drop
apply(rare.drop,MARGIN = 2,cor,meta.drop,method="spearman")
apply(rare.drop,MARGIN = 2,cor,meta.drop,method="spearman")[1:20]
apply(rare.drop,MARGIN = 2,cor,meta.drop,method="pearson")[1:20]
sign(apply(rare.drop,MARGIN = 2,cor,meta.drop,method="spearman"))->response
response[1:20]
cbind(phylo,response)->phylo
sum(names(response)!=phylo.drop$X.OTU.ID)
phylo.drop$X.OTU.ID %in% rownames(FDR.drop)
View(temp)
dim(temp)
dim(FDR.drop)
if(sum(names(ifsignificant)!=phylo.drop$X.OTU.ID)==0)
if(sum(names(response)!=phylo.drop$X.OTU.ID)==0)
cbind(phylo.drop,response)->anno.drop
ifsignificant<-(phylo.drop$X.OTU.ID %in% rownames(temp))
if(sum(names(ifsignificant)!=phylo.drop$X.OTU.ID)==0)
if(sum(names(response)!=phylo.drop$X.OTU.ID)==0)
cbind(phylo.drop,response)->anno.drop
View(temp)
View(phylo.drop)
ifsignificant[1:20]
phylo[phylo$X.OTU.ID %in% rownames(FDR.drop),]->phylo.drop
ifsignificant<-(phylo.drop$X.OTU.ID %in% rownames(temp))
if(sum(names(response)!=phylo.drop$X.OTU.ID)==0)
cbind(phylo.drop,response,ifsignificant)->anno.drop
View(anno.drop)
View(anno.drop[anno.drop$ifsignificant,])
getwd()
write.csv(anno.drop[anno.drop$ifsignificant,],"temp.csv")
replicate(sum(sign(rnorm(95))),1000)->test
replicate(10000,sum(sign(rnorm(95))))->test
hist(test)
replicate(1000000,sum(sign(rnorm(95))))->test
hist(test)
max(test)
rm(test)
library(vegan)
diversity(rare)
source('D:/World Forest Data/Fuyang/data/1Description/Description.R')
plot(meta,shannon)
library(ggplot2)
qplot(x=meta,y=shannon)
qplot(x=meta$meta,y=shannon)
meta$meta
length(Sample.Type)
Sample.Type
kruskal.test(shannon~Sample.Type)
kruskal.test(shannon~meta$meta)
str(meta)
anova(shannon~Sample.Type)
lm(shannon~Sample.Type)
lm(shannon~meta$meta)
anova(lm(shannon~Sample.Type))
View(rare)
shannon
lm(shannon~Sample.Type,weights = c(0.5,0.5,0.5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.5,1,1))
anova(lm(shannon~Sample.Type,weights = c(0.5,0.5,0.5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,)1,1,1,1,1,0.5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.5,1,1))
anova(lm(shannon~Sample.Type,weights = c(0.5,0.5,0.5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.5,1,1)))
anova(lm(shannon~Sample.Type))
source('D:/World Forest Data/Fuyang/data/1Description/Description.R')
library(picante)
pd(rare,root.phylotre)
pd(rare,root.phylotre)$PD->faith
rm(temp,temp.drop,temp1,temp2,temp3,temp4)
rm(faith,shannon)
rm(comm)
View(anno)
View(anno.drop)
dim(w0.5unifrac)
w0.5unifrac<-w0.5unifrac[1:45,1:45]
View(rare)
rownames(rare)<-c("Unburnt1","Unburnt2","Unburnt3","Unburnt4","Unburnt5","Unburnt6","Unburnt7","Unburnt8","Unburnt9","Unburnt10","Unburnt11","Unburnt12","BCU1_2","BCU1_3","BCU2_1","BCU2_2","BCU3_1","BCU3_3","BCU4_1","BCU4_2","BCU4_3","BCW1_1","BCW1_2","BCW1_3","BCW2_1","BCW2_2","BCW2_3","BCW3_1","BCW3_2","BCW3_3","BCW4_1","BCW4_2","BCW4_3","Burnt1_1","Burnt1_2","Burnt1_3","Burnt2_1","Burnt2_2","Burnt2_3","Burnt3_1","Burnt3_2","Burnt3_3","Burnt4_1","Burnt4_2","Burnt4_3")
rownames(rare)
rownames(rare)<-c("Unburnt1","Unburnt2","Unburnt3","Unburnt4","Unburnt5","Unburnt6","Unburnt7","Unburnt8","Unburnt9","Unburnt10","Unburnt11","Unburnt12","BCU1_2","BCU1_3","BCU2_1","BCU2_2","BCU3_1","BCU3_3","BCU4_1","BCU4_2","BCU4_3","BCW1_1","BCW1_2","BCW1_3","BCW2_1","BCW2_2","BCW2_3","BCW3_1","BCW3_2","BCW3_3","BCW4_1","BCW4_2","BCW4_3","Burnt1_1","Burnt1_2","Burnt1_3","Burnt2_1","Burnt2_2","Burnt2_3","Burnt3_1","Burnt3_2","Burnt3_3","Burnt4_1","Burnt4_2","Burnt4_3")
View(w0.5unifrac)
colnames(w0.5unifrac)<-rownames(w0.5unifrac)<-rownames(rare)
colnames(w0.5unifrac)<-rownames(rare)
View(w0.5unifrac)
rm(pic1,pic2,pic3,PicA,PicB,p1,p2,p)
rm(W0.5UF.NMDS.pic1)
load("D:/World Forest Data/Fuyang/data/2Ordination&Permanova/.RData")
View(w0.5unifrac)
View(w0.5unifrac.m)
View(NMDS0.5uf.point)
View(w0.5unifrac)
load("D:/World Forest Data/Fuyang/data/2Ordination&Permanova/.RData")
rm(ordinationAll,ordinationSub,obj1,obj2,MDS12,MDS12.sub,MDS13,MDS13.sub,MDS13.sub,MDS23,MDS23.sub)
rm(i,n,Heatmap.UF,w0.5unifrac.m,test)
rm(anno.corr)
q()
View(anno)
View(anno.data)
View(anno.drop)
View(anno.data)
phylogeny
View(phylo)
View(phylo)
View(phylo.drop)
View(phylo.rare)
rm(FDR,FDR.drop,NMDS0.5uf,NMDS0.5uf.point,anno,anno.data,anno.drop)
rm(w0.5unifrac,obj,relabun,index,result,result.drop,ifsignificant)
rm(unifrac,Sig,Sig.drop,Nul,Nul.drop)
rm(response)
rm(ifwash)
rm(phylo,phylo.drop,phylo.rare)
View(otudata)
View(data)
View(data)
rowSums(data)
colSums(otudata)
View(rare)
View(rare.drop)
source('~/.active-rstudio-document', echo=TRUE)
getwd()
colnames(data)<-c("Unburnt1","Unburnt2","Unburnt3","Unburnt4","Unburnt5","Unburnt6",
"Unburnt7","Unburnt8","Unburnt9","Unburnt10","Unburnt11","Unburnt12",
"BCU1_2","BCU1_3","BCU2_1","BCU2_2","BCU3_1","BCU3_3","BCU4_1","BCU4_2",
"BCU4_3","BCW1_1","BCW1_2","BCW1_3","BCW2_1","BCW2_2","BCW2_3","BCW3_1",
"BCW3_2","BCW3_3","BCW4_1","BCW4_2","BCW4_3","Burnt1_1","Burnt1_2",
"Burnt1_3","Burnt2_1","Burnt2_2","Burnt2_3","Burnt3_1","Burnt3_2",
"Burnt3_3","Burnt4_1","Burnt4_2","Burnt4_3")
str(data)
View(data)
colnames(data)
read.csv("16S.uparse.csv",header=TRUE)->otudata
rownames(otudata)<-otudata[,1]
otudata<-otudata[,-1]
View(rare)
View(otudata)
View(otudata)
data<-[,-ncol(otudata)]
data<-otudata[,-ncol(otudata)]
data<-data[,-((ncol(data)-2):ncol(data))]
View(data)
colnames(data)<-c("Unburnt1","Unburnt2","Unburnt3","Unburnt4","Unburnt5","Unburnt6",
"Unburnt7","Unburnt8","Unburnt9","Unburnt10","Unburnt11","Unburnt12",
"BCU1_2","BCU1_3","BCU2_1","BCU2_2","BCU3_1","BCU3_3","BCU4_1","BCU4_2",
"BCU4_3","BCW1_1","BCW1_2","BCW1_3","BCW2_1","BCW2_2","BCW2_3","BCW3_1",
"BCW3_2","BCW3_3","BCW4_1","BCW4_2","BCW4_3","Burnt1_1","Burnt1_2",
"Burnt1_3","Burnt2_1","Burnt2_2","Burnt2_3","Burnt3_1","Burnt3_2",
"Burnt3_3","Burnt4_1","Burnt4_2","Burnt4_3")
View(data)
data<-otudata[,-ncol(otudata)]
data<-data[,-((ncol(data)-2):ncol(data))]
colnames(data)<-c("Unburnt1","Unburnt2","Unburnt3","Unburnt4","Unburnt5","Unburnt6",
"Unburnt7","Unburnt8","Unburnt9","Unburnt10","Unburnt11","Unburnt12",
"BCU1_2","BCU1_3","BCU2_1","BCU2_2","BCU3_1","BCU3_3","BCU4_1","BCU4_2",
"BCU4_3","BCW1_1","BCW1_2","BCW1_3","BCW2_1","BCW2_2","BCW2_3","BCW3_1",
"BCW3_2","BCW3_3","BCW4_1","BCW4_2","BCW4_3","Burnt1_1","Burnt1_2",
"Burnt1_3","Burnt2_1","Burnt2_2","Burnt2_3","Burnt3_1","Burnt3_2",
"Burnt3_3","Burnt4_1","Burnt4_2","Burnt4_3")
read.csv("rare.csv",header=TRUE)->rare
rownames(rare)<-rare[,1]
rare<-rare[,-1]
rare<-rare[,-((ncol(rare)-2):ncol(rare))] #remove the last three columns
colnames(rare)<-colnames(data)
View(rare)
read.csv("rare.csv",header=TRUE)->rare
View(rare)
rownames(rare)<-rare[,1]
rare<-rare[,-1]
rare<-rare[,-((ncol(rare)-2):ncol(rare))] #remove the last three columns
View(rare)
colnames(rare)<-colnames(data)
rare.drop<-rare[,c(-1,-3)]
read.csv("Phylogeny.csv",header=TRUE)->phylo
ape::read.tree("16S.refined.tre",header=TRUE)->phylotre
ape::read.tree("16S.refined.tre")->phylotre
root(phylotre, 1, r = TRUE)->root.phylotre
r
ape::root(phylotre, 1, r = TRUE)->root.phylotre
View(data)
data<-t(data)
View(data)
View(phylo)
View(data)
View(rare)
View(rare.drop)
View(rare)
t(rare)->rare
View(rare.drop)
read.csv("16S.uparse.csv",header=TRUE)->otudata
rownames(otudata)<-otudata[,1]
otudata<-otudata[,-1]
data<-otudata[,-ncol(otudata)]
data<-data[,-((ncol(data)-2):ncol(data))]
colnames(data)<-c("Unburnt1","Unburnt2","Unburnt3","Unburnt4","Unburnt5","Unburnt6",
"Unburnt7","Unburnt8","Unburnt9","Unburnt10","Unburnt11","Unburnt12",
"BCU1_2","BCU1_3","BCU2_1","BCU2_2","BCU3_1","BCU3_3","BCU4_1","BCU4_2",
"BCU4_3","BCW1_1","BCW1_2","BCW1_3","BCW2_1","BCW2_2","BCW2_3","BCW3_1",
"BCW3_2","BCW3_3","BCW4_1","BCW4_2","BCW4_3","Burnt1_1","Burnt1_2",
"Burnt1_3","Burnt2_1","Burnt2_2","Burnt2_3","Burnt3_1","Burnt3_2",
"Burnt3_3","Burnt4_1","Burnt4_2","Burnt4_3")
read.csv("rare.csv",header=TRUE)->rare
rownames(rare)<-rare[,1]
rare<-rare[,-1]
rare<-rare[,-((ncol(rare)-2):ncol(rare))] #remove the last three columns
colnames(rare)<-colnames(data)
rare.drop<-rare[,c(-1,-3)]
t(rare)->rare
t(rare.drop)->rare.drop
data<-t(data)
read.csv("Phylogeny.csv",header=TRUE)->phylo
ape::read.tree("16S.refined.tre")->phylotre
ape::root(phylotre, 1, r = TRUE)->root.phylotre
View(data)
View(rare)
View(rare.drop)
View(rare.drop)
dim(rare.drop)
rm(rare.drop)
rm(meta.drop)
dim(data)
dim(rare)
View(phylo)
dim(phylo)
length(which(phylo$Domain=="Eukarya"))
length(which(phylo$Domain=="Archaea"))
length(which(phylo$Domain=="Unassigned"))
